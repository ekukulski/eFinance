<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="eFinance.Pages.AccountsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Accounts"
    x:Name="ThisPage">

    <Grid RowDefinitions="Auto,*" Padding="12" RowSpacing="10">

        <!-- Header + top buttons -->
        <Grid Grid.Row="0" ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
            <Label Text="Accounts"
                   FontSize="20"
                   FontAttributes="Bold"
                   VerticalOptions="Center" />

            <Button Grid.Column="1"
                    Text="Add"
                    Command="{Binding AddAccountCommand}" />

            <Button Grid.Column="2"
                    Text="{Binding ShowInactiveButtonText}"
                    Command="{Binding ToggleInactiveCommand}" />
        </Grid>

        <!-- List -->
        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Accounts}"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <Label Text="No accounts yet."
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       Opacity="0.7" />
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10" CornerRadius="12" HasShadow="True">
                        <Grid ColumnDefinitions="*,Auto,Auto,Auto" ColumnSpacing="10">
                            <StackLayout Spacing="2">
                                <Label Text="{Binding Name}"
                                       FontAttributes="Bold"
                                       FontSize="16" />
                                <Label Text="{Binding AccountType}"
                                       Opacity="0.7"
                                       FontSize="12" />
                            </StackLayout>

                            <Button Grid.Column="1"
                                    Text="Open"
                                    Command="{Binding BindingContext.OpenRegisterCommand, Source={x:Reference ThisPage}}"
                                    CommandParameter="{Binding Id}" />

                            <Button Grid.Column="2"
                                    Text="Rename"
                                    Command="{Binding BindingContext.RenameAccountCommand, Source={x:Reference ThisPage}}"
                                    CommandParameter="{Binding .}" />

                            <!-- Deactivate or Reactivate depending on IsActive -->
                            <Button Grid.Column="3"
                                    Command="{Binding BindingContext.ToggleActiveCommand, Source={x:Reference ThisPage}}"
                                    CommandParameter="{Binding .}">
                                <Button.Triggers>
                                    <DataTrigger TargetType="Button"
                                                 Binding="{Binding IsActive}"
                                                 Value="True">
                                        <Setter Property="Text" Value="Deactivate" />
                                    </DataTrigger>
                                    <DataTrigger TargetType="Button"
                                                 Binding="{Binding IsActive}"
                                                 Value="False">
                                        <Setter Property="Text" Value="Reactivate" />
                                    </DataTrigger>
                                </Button.Triggers>
                            </Button>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>
</ContentPage>